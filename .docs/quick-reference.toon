# PacketBuddy Quick Reference - TOON Format

[meta]
version = "1.4.3"
updated = "2026-02-20"

[onboarding_shortcut]
windows = "Run setup.bat in root (as Admin)"
unix = "Run ./setup.sh in root"
verify = "http://127.0.0.1:7373/dashboard"

[cli_commands]
today = "pb today (Usage stats)"
summary = "pb summary (Lifetime stats)"
month = "pb month (Current month breakdown)"
export_csv = "pb export --format csv"
export_json = "pb export --format json"
export_html = "pb export --format html (Year Wrap-up)"
export_llm = "pb export --llm (TOON format)"
service_start = "pb service start"
service_stop = "pb service stop"
service_restart = "pb service restart"
update = "pb update (Self-update)"

[storage_commands]
stats = "pb stats (Local database stats)"
storage_stats = "pb storage stats (Detailed local storage info)"
storage_neon = "pb storage neon (NeonDB storage usage and warnings)"
storage_cleanup = "pb storage cleanup (Clean old synced logs)"
storage_cleanup_neon = "pb storage cleanup --neon (Clean NeonDB old logs)"
storage_cleanup_aggressive = "pb storage cleanup --neon --aggressive (Emergency cleanup)"
neon_cleanup = "pb neon-cleanup (Quick aggressive NeonDB cleanup)"

[api_endpoints]
base = "http://127.0.0.1:7373/api"
health = "/health"
live = "/live (Real-time speed)"
today = "/today"
month = "/month?month=YYYY-MM"
export = "/export?format=csv|json|html|llm"

[api_endpoints_storage]
storage = "/api/storage (Local + NeonDB storage stats)"
storage_cleanup = "/api/storage/cleanup?aggressive=true&vacuum=true (POST trigger cleanup)"

[issue_1_windows_not_starting]
symptom = "Dashboard won't load, API connection refused"
solution = "1. Check if pythonw.exe is running in Task Manager. 2. Run setup.bat as Administrator. 3. Check logs in %USERPROFILE%\\.packetbuddy\\stderr.log"

[issue_2_old_version_showing]
symptom = "Dashboard shows old version but code is newer"
cause = "Python module caching or stale VERSION file"
fix = "v1.4.2 uses dynamic versioning from VERSION file - restart the service or run 'pb update'"

[issue_3_port_in_use]
symptom = "Error: [Errno 10048] Only one usage of each socket address"
fix = "Update port in %USERPROFILE%\\.packetbuddy\\config.toml [api] section"

[issue_4_no_catch_up_data]
symptom = "First run after reboot shows zero usage"
cause = "Expected behavior - app records usage from when it started, not before"
fix = "v1.4.2 has catch-up logic - if app was running during boot, usage should auto-catch-up"

[issue_5_service_not_recovering]
symptom = "Service stops after system sleep/hibernate"
cause = "Task Scheduler watchdog should auto-restart within 60 minutes"
fix = "Check Task Scheduler for 'PacketBuddy' task. Run: schtasks /query /tn PacketBuddy"

[config_keys]
location = "Windows: %USERPROFILE%\\.packetbuddy\\config.toml | Unix: ~/.packetbuddy/config.toml"
poll_interval = "seconds (default 1)"
batch_write_interval = "seconds (default 30)"
sync_enabled = "true/false"
neondb_url = "postgresql connection string"

[config_storage]
log_retention_days = "Local: 30 days default"
neon_log_retention_days = "NeonDB: 7 days default (free tier optimized)"
aggregate_retention_months = "Local: 12 months"
neon_aggregate_retention_months = "NeonDB: 3 months"
cleanup_interval_hours = "24 hours default"

[security_note]
secrets = "NEVER push config.toml with neondb credentials. It is gitignored by default."
binding = "Service only accepts local connections (127.0.0.1)"

[for_ai_agents]
docs_index = ".docs/index.toon"
token_optimized = "Use .docs/*.toon for codebase context"
