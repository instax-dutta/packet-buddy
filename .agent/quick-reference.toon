# PacketBuddy Quick Reference - TOON Format

[meta]
doc_type = "quick_reference"
purpose = "Fast troubleshooting and common issues"
updated = "2026-01-08"

[what_is_packetbuddy]
desc = "Ultra-lightweight network usage tracker"
features = ["Monitors upload/download bandwidth", "Runs silently (<40MB RAM, <0.5% CPU)", "Web dashboard at http://127.0.0.1:7373/dashboard", "Cross-platform (Windows, macOS, Linux)", "Local storage (SQLite) + optional cloud sync (NeonDB)"]

[quick_setup]
windows = "git clone → service\\windows\\setup.bat (as Admin) → http://127.0.0.1:7373/dashboard"
macos = "git clone → chmod +x service/macos/setup.sh → ./service/macos/setup.sh → open http://127.0.0.1:7373/dashboard"
linux = "git clone → bash service/linux/setup.sh → xdg-open http://127.0.0.1:7373/dashboard"

[issue_1_windows_task_scheduler]
symptoms = "Works from cmd, fails from Task Scheduler"
solution = "Re-run: service\\windows\\setup.bat (as Admin)"
details = "docs/WINDOWS_TASK_SCHEDULER_FIX.md"
root_cause = "Missing PYTHONPATH. Fixed with run-service.bat launcher (v1.0.1)"

[issue_2_dashboard_not_loading]
symptoms = "ERR_CONNECTION_REFUSED or site can't be reached"
check = "curl http://127.0.0.1:7373/api/health"
start_service = {windows="schtasks /run /tn PacketBuddy", macos="launchctl kickstart -k gui/$(id -u)/com.packetbuddy.daemon", linux="systemctl --user start packetbuddy.service"}

[issue_3_port_in_use]
error = "Address already in use: 127.0.0.1:7373"
solution = "Edit ~/.packetbuddy/config.toml → [api] port = 8080"
then = "Restart service, access http://127.0.0.1:8080/dashboard"

[issue_4_python_not_found]
solution = [
  "Download Python 3.11+ from python.org",
  "During install: CHECK 'Add Python to PATH'",
  "Restart Command Prompt",
  "Verify: python --version"
]

[file_locations]
config = {windows="%USERPROFILE%\\.packetbuddy\\config.toml", unix="~/.packetbuddy/config.toml"}
database = {windows="%USERPROFILE%\\.packetbuddy\\packetbuddy.db", unix="~/.packetbuddy/packetbuddy.db"}
logs = {windows="%USERPROFILE%\\.packetbuddy\\stderr.log", unix="~/.packetbuddy/stderr.log"}

[service_control]
windows = {start="schtasks /run /tn PacketBuddy", stop="schtasks /end /tn PacketBuddy", status="schtasks /query /tn PacketBuddy"}
macos = {start="launchctl load ~/Library/LaunchAgents/com.packetbuddy.plist", stop="launchctl unload ~/Library/LaunchAgents/com.packetbuddy.plist", status="launchctl list | grep packetbuddy"}
linux = {start="systemctl --user start packetbuddy.service", stop="systemctl --user stop packetbuddy.service", status="systemctl --user status packetbuddy.service"}

[cli_commands]
usage = ["pb today", "pb summary", "pb month", "pb export"]
service = ["pb service start", "pb service stop", "pb service restart"]
update = ["pb update --check-only", "pb update", "pb update --force"]

[api_endpoints]
health = "GET /api/health → Service status"
live = "GET /api/live → Current speed"
today = "GET /api/today → Today's usage"
month = "GET /api/month?month=YYYY-MM → Monthly breakdown"
summary = "GET /api/summary → Lifetime totals"
export = "GET /api/export?format=csv → Export data"

[config_example]
location = "~/.packetbuddy/config.toml"
sections = """
[api]
host = "127.0.0.1"
port = 7373

[monitoring]
poll_interval = 1
batch_write_interval = 30

[sync]
enabled = false

[auto_update]
enabled = true
check_on_startup = true
auto_apply = true
auto_restart = true
"""

[multi_device_setup]
steps = [
  "Create NeonDB account at neon.tech",
  "Get connection string",
  "Set env: export NEON_DB_URL='postgresql://...'",
  "Run setup on each device"
]

[key_files]
monitor = "src/core/monitor.py"
storage = "src/core/storage.py"
sync = "src/core/sync.py"
api_server = "src/api/server.py"
api_routes = "src/api/routes.py"
cli = "src/cli/main.py"
dashboard = "dashboard/index.html"
windows_launcher = "run-service.bat"

[recent_changes]
v1_2_1 = "Resource optimization (batch_write_interval: 5s → 30s, 83% less disk I/O)"
v1_2_0 = "TOON format migration (60% token savings)"
v1_1_2 = "Enhanced setup error handling"
v1_1_1 = "Auto-update config defaults"
v1_1_0 = "Automatic updates enabled"
v1_0_1 = "Windows Task Scheduler fix (run-service.bat)"

[uninstall]
windows = ["schtasks /delete /tn PacketBuddy /f", "rmdir /s /q %USERPROFILE%\\.packetbuddy"]
macos = ["launchctl unload ~/Library/LaunchAgents/com.packetbuddy.plist", "rm ~/Library/LaunchAgents/com.packetbuddy.plist", "rm -rf ~/.packetbuddy"]
linux = ["systemctl --user stop packetbuddy.service", "systemctl --user disable packetbuddy.service", "rm ~/.config/systemd/user/packetbuddy.service", "rm -rf ~/.packetbuddy"]

[performance]
cpu = "0.2-0.5%"
ram = "28-40 MB"
disk_io = "~5 KB/s"
network_overhead = "~1 KB/30s (sync)"
api_response = "<50ms"

[privacy]
collected = ["bytes_sent", "bytes_received", "timestamp", "device_id"]
not_collected = ["websites", "app names", "IP addresses", "DNS queries", "personal info"]
security = ["API: 127.0.0.1 only", "NeonDB: TLS encryption", "Credentials: environment variables"]

[faq]
q1 = {q="Does it slow down internet?", a="No. Only reads statistics, doesn't intercept traffic."}
q2 = {q="Can I track multiple devices?", a="Yes, with optional NeonDB cloud sync (free tier)."}
q3 = {q="How accurate is it?", a="Very accurate - reads kernel-level network statistics."}
q4 = {q="Does it work offline?", a="Yes, local tracking works 100% offline. Cloud sync requires internet."}
q5 = {q="How do I export data?", a="pb export --format csv OR visit /api/export?format=csv"}

[debugging]
view_logs = {windows="type %USERPROFILE%\\.packetbuddy\\stderr.log", unix="tail -f ~/.packetbuddy/stderr.log"}
test_api = "curl http://127.0.0.1:7373/api/health"
check_db = "sqlite3 ~/.packetbuddy/packetbuddy.db → .schema → SELECT * FROM network_usage LIMIT 10;"
manual_start = "cd packet-buddy → venv/Scripts/activate → python -m src.api.server"

[support]
github = "https://github.com/instax-dutta/packet-buddy"
issues = "https://github.com/instax-dutta/packet-buddy/issues"
discussions = "https://github.com/instax-dutta/packet-buddy/discussions"

[for_llms]
use_when = "User has problem or question"
contains = ["Common issues", "Service control", "File locations", "API endpoints", "Recent changes"]
best_for = "Fast answers to user questions"
